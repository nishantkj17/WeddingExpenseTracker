<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Expense Tracker</title>
    
    <!-- Material UI CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom Material Styles -->
    <link rel="stylesheet" href="css/material-custom.css">
</head>
<body class="grey lighten-4">
<body class="grey lighten-5">
    <!-- Navigation Bar -->
    <nav class="white">
        <div class="nav-wrapper container">
            <ul id="nav-mobile" class="left">
                <li class="active"><a href="index.html" class="grey-text text-darken-2"><i class="material-icons left">payment</i>Expenses</a></li>
                <li><a href="guests.html" class="grey-text text-darken-2"><i class="material-icons left">people</i>Guests</a></li>
            </ul>
        </div>
    </nav>

    <div class="container" style="margin-top: 10px;">
        <!-- All Collapsible Sections Combined -->
        <ul class="collapsible" style="margin-top: 0;">
            <!-- Dashboard & Charts -->
            <li class="active">
                <div class="collapsible-header" style="padding: 8px 12px;">
                    <i class="material-icons">dashboard</i>
                    Dashboard & Charts
                </div>
                <div class="collapsible-body white" style="padding: 0;">
                    <!-- Summary Dashboard Carousel - Swipe through Dashboard Summary and Charts -->
                    <div class="carousel carousel-slider" style="margin-bottom: 0; border: none; border-radius: 0; overflow: hidden;" id="dashboardCarousel">
                        <!-- Combined Dashboard Summary Slide -->
                        <div class="carousel-item white">
                            <div class="card-content" style="padding: 12px;">
                                <div class="row" style="margin: 0;">
                                    <!-- Budget Overview -->
                                    <div class="col s12 m6" style="padding: 5px;">
                                        <span class="card-title grey-text text-darken-2" style="font-size: 0.9rem; margin-bottom: 5px; display: block; font-weight: 500;">üí∞ Budget Overview</span>
                                        <div class="row" style="margin-bottom: 5px;">
                                            <div class="input-field col s8" style="margin: 0;">
                                                <input id="budgetInput" type="number" placeholder="Enter budget" style="margin-bottom: 0; font-size: 0.8rem; height: 1.8rem;">
                                            </div>
                                            <div class="col s4" style="padding-top: 0;">
                                                <button id="updateBudgetBtn" class="btn-small waves-effect waves-light blue-grey darken-1" style="margin: 0; width: 100%; height: 26px; line-height: 26px;">
                                                    <i class="material-icons" style="font-size: 0.85rem;">update</i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="progress grey lighten-3" style="margin: 5px 0; height: 5px;">
                                            <div id="progressFill" class="determinate blue-grey darken-1" style="width: 0%"></div>
                                        </div>
                                        <p id="progressText" class="center-align grey-text" style="margin: 2px 0 0 0; font-size: 0.75rem;">0% spent</p>
                                    </div>
                                    
                                    <!-- Balances -->
                                    <div class="col s12 m6" style="padding: 5px;">
                                        <span class="card-title grey-text text-darken-2" style="font-size: 0.9rem; margin-bottom: 5px; display: block; font-weight: 500;">üìä Balances</span>
                                        <div class="row" style="margin: 0;">
                                            <div class="col s6 center-align" style="border-right: 1px solid #e0e0e0; padding: 5px;">
                                                <small class="grey-text" style="font-size: 0.7rem;">Cash Left</small>
                                                <h6 id="remainingCash" class="grey-text text-darken-2" style="margin: 3px 0; font-size: 1.1rem; font-weight: 500;">‚Çπ0.00</h6>
                                                <small class="grey-text" style="font-size: 0.6rem;">Paid expenses</small>
                                            </div>
                                            <div class="col s6 center-align" style="padding: 5px;">
                                                <small class="grey-text" style="font-size: 0.7rem;">To Pay</small>
                                                <h6 id="toBePaidLater" class="orange-text text-darken-2" style="margin: 3px 0; font-size: 1.1rem; font-weight: 500;">‚Çπ0.00</h6>
                                                <small class="grey-text" style="font-size: 0.6rem;">Remaining</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="divider" style="margin: 8px 0;"></div>
                                
                                <div class="row" style="margin: 0;">
                                    <!-- Who Paid -->
                                    <div class="col s12 m6" style="padding: 5px;">
                                        <span class="card-title grey-text text-darken-2" style="font-size: 0.9rem; margin-bottom: 5px; display: block; font-weight: 500;">üë• Who Paid</span>
                                        <div id="whoPaidSection" style="font-size: 0.8rem;">
                                            <!-- Dynamically populated -->
                                        </div>
                                    </div>
                                    
                                    <!-- Money Received -->
                                    <div class="col s12 m6" style="padding: 5px; margin-top: 10px;">
                                        <span class="card-title grey-text text-darken-2" style="font-size: 0.9rem; margin-bottom: 5px; display: block; font-weight: 500;">üíµ Money Received</span>
                                        <div class="row" style="margin: 3px 0;">
                                            <div class="col s4" style="padding: 0 5px;">
                                                <small class="grey-text" style="font-size: 0.65rem; display: block; margin-bottom: 2px;">Ranjana</small>
                                                <input id="ranjanaReceived" type="number" step="0.01" placeholder="0" style="margin: 0; font-size: 0.8rem; height: 1.8rem;">
                                            </div>
                                            <div class="col s4" style="padding: 0 5px;">
                                                <small class="grey-text" style="font-size: 0.65rem; display: block; margin-bottom: 2px;">Mummy</small>
                                                <input id="mummyReceived" type="number" step="0.01" placeholder="0" style="margin: 0; font-size: 0.8rem; height: 1.8rem;">
                                            </div>
                                            <div class="col s4" style="padding: 0 5px;">
                                                <small class="grey-text" style="font-size: 0.65rem; display: block; margin-bottom: 2px;">Choti</small>
                                                <input id="chotiReceived" type="number" step="0.01" placeholder="0" style="margin: 0; font-size: 0.8rem; height: 1.8rem;">
                                            </div>
                                        </div>
                                        <button id="saveReceivedBtn" class="btn-small waves-effect waves-light blue-grey darken-1" style="margin-top: 3px; height: 26px; line-height: 26px;">
                                            <i class="material-icons left tiny" style="font-size: 0.8rem;">save</i><span style="font-size: 0.7rem;">Save</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chart 1: Category-wise Spending -->
                        <div class="carousel-item white">
                            <div class="card-content" style="padding: 15px;">
                                <span class="card-title grey-text text-darken-2" style="font-size: 0.95rem; margin-bottom: 5px; display: block;">üí∞ Category Spending</span>
                                <div class="input-field" style="margin: 3px auto; max-width: 300px;">
                                    <select id="categoryChartFilter" multiple style="font-size: 0.8rem;">
                                        <option value="" disabled>Select categories</option>
                                    </select>
                                </div>
                                <div style="height: 450px;">
                                    <canvas id="categoryChart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chart 2: Top 10 Expenses -->
                        <div class="carousel-item white">
                            <div class="card-content" style="padding: 15px;">
                                <span class="card-title grey-text text-darken-2" style="font-size: 0.95rem; margin-bottom: 5px; display: block.">üèÜ Top 10 Expenses</span>
                                <div style="height: 480px;">
                                    <canvas id="topExpensesChart"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Chart 3: Payment Status -->
                        <div class="carousel-item white">
                            <div class="card-content" style="padding: 15px;">
                                <span class="card-title grey-text text-darken-2" style="font-size: 0.95rem; margin-bottom: 5px; display: block;">üìä Payment Status</span>
                                <div style="height: 480px;">
                                    <canvas id="paymentStatusChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </li>

            <!-- Add Expense -->
            <li>
                <div class="collapsible-header" style="padding: 8px 12px;">
                    <i class="material-icons">add_circle</i>
                    Add New Expense
                </div>
                <div class="collapsible-body white" style="padding: 12px;">
                    <form id="expenseForm">
                        <div class="row" style="margin-bottom: 5px;">
                            <div class="input-field col s12 m4" style="margin-top: 0;">
                                <input type="text" id="category" list="categoryList" placeholder="Category" required>
                                <datalist id="categoryList"></datalist>
                            </div>
                            <div class="input-field col s12 m4" style="margin-top: 0;">
                                <input type="text" id="subCategory" list="subCategoryList" placeholder="Sub Category">
                                <datalist id="subCategoryList"></datalist>
                            </div>
                            <div class="input-field col s12 m4" style="margin-top: 0;">
                                <input type="text" id="description" placeholder="Description" required>
                            </div>
                        </div>

                        <div class="row" style="margin-bottom: 5px;">
                            <div class="input-field col s6 m3" style="margin-top: 0;">
                                <select id="paidBy" required>
                                    <option value="" disabled selected>Paid By</option>
                                    <option value="Ranjana">Ranjana</option>
                                    <option value="Mummy">Mummy</option>
                                    <option value="Choti">Choti</option>
                                </select>
                            </div>
                            <div class="input-field col s6 m3" style="margin-top: 0;">
                                <input type="number" id="cost" step="0.01" placeholder="Cost" required>
                            </div>
                            <div class="input-field col s12 m3" style="margin-top: 0;">
                                <input type="date" id="expenseDate" placeholder="Date">
                            </div>
                            <div class="col s12 m3" style="padding-top: 10px;">
                                <label>
                                    <input type="checkbox" id="hasRemaining" />
                                    <span style="font-size: 0.85rem;">Has Remaining</span>
                                </label>
                            </div>
                        </div>

                        <div class="row" id="totalCostDisplay" style="display: none; margin-bottom: 5px;">
                            <div class="input-field col s12" style="margin-top: 0;">
                                <input type="text" id="totalCost" placeholder="Total Cost" readonly style="background-color: #f5f5f5;">
                            </div>
                        </div>

                        <div id="remainingPaymentSection" style="display: none;">
                            <div class="row" style="margin-bottom: 5px;">
                                <div class="input-field col s6" style="margin-top: 0;">
                                    <input type="number" id="remainingAmount" step="0.01" placeholder="Remaining Amount">
                                </div>
                                <div class="input-field col s6" style="margin-top: 0;">
                                    <input type="date" id="remainingDate" placeholder="Due Date">
                                </div>
                            </div>
                            <div class="row" style="margin-bottom: 5px;">
                                <div class="input-field col s12" style="margin-top: 0;">
                                    <textarea id="remainingNotes" class="materialize-textarea" placeholder="Notes" style="min-height: 40px;"></textarea>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="btn-small waves-effect waves-light blue-grey darken-1">
                            <i class="material-icons left">add</i>Add Expense
                        </button>
                        <button type="button" id="cancelEditBtn" class="btn-small waves-effect waves-light grey" style="display: none;">
                            <i class="material-icons left">cancel</i>Cancel
                        </button>
                    </form>
                </div>
            </li>
            
            <!-- Expense List -->
            <li>
                <div class="collapsible-header" style="padding: 8px 12px;">
                    <i class="material-icons">list</i>
                    Expense List
                </div>
                <div class="collapsible-body white" style="padding: 10px;">
                    <div class="row" style="margin-bottom: 5px;">
                        <div class="input-field col s4 m4" style="margin: 0;">
                            <input type="text" id="filterCategory" placeholder="Search..." style="margin: 0; height: 35px; font-size: 0.85rem;">
                        </div>
                        <div class="input-field col s4 m4" style="margin: 0;">
                            <select id="filterPaidBy" style="height: 35px;">
                                <option value="">All</option>
                                <option value="Ranjana">Ranjana</option>
                                <option value="Mummy">Mummy</option>
                                <option value="Choti">Choti</option>
                            </select>
                        </div>
                        <div class="input-field col s4 m4" style="margin: 0;">
                            <label>
                                <input type="checkbox" id="filterPendingOnly" class="filled-in" />
                                <span style="font-size: 0.8rem; color: #546e7a;">Pending Pmt</span>
                            </label>
                        </div>
                    </div>
                    <div id="expensesList" style="max-height: 60vh; overflow-y: auto;">
                        <!-- Expenses will be dynamically loaded here -->
                    </div>
                </div>
            </li>
        </ul>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <h4 id="paymentModalTitle" class="grey-text text-darken-2"><i class="material-icons">payment</i> Add Payment</h4>
            <div id="paymentExpenseDetails" class="card-panel grey lighten-4">
                <!-- Expense details will be populated here -->
            </div>
            <form id="paymentForm">
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">money</i>
                        <input type="number" id="paymentAmount" step="0.01" required>
                        <label for="paymentAmount">Payment Amount *</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <select id="paymentPaidBy" required>
                            <option value="" disabled selected>Select who paid...</option>
                            <option value="Ranjana">Ranjana</option>
                            <option value="Mummy">Mummy</option>
                            <option value="Choti">Choti</option>
                        </select>
                        <label>Paid By *</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">event</i>
                        <input type="date" id="paymentDate">
                        <label for="paymentDate">Payment Date</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <i class="material-icons prefix">notes</i>
                        <textarea id="paymentNotes" class="materialize-textarea"></textarea>
                        <label for="paymentNotes">Notes (Optional)</label>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancel</a>
            <a href="#!" class="waves-effect waves-green btn blue-grey darken-1" onclick="submitPayment(event)">
                <i class="material-icons left">add</i>Add Payment
            </a>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h5 id="confirmTitle">Confirm Action</h5>
            <p id="confirmMessage"></p>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-close waves-effect waves-grey btn-flat">Cancel</a>
            <a href="#!" id="confirmActionBtn" class="modal-close waves-effect waves-red btn red" onclick="executeConfirmAction()">Delete</a>
        </div>
    </div>

    <!-- Info Modal -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <h5 id="infoTitle">Information</h5>
            <p id="infoMessage" style="white-space: pre-line;"></p>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-close waves-effect waves-green btn-flat">OK</a>
        </div>
    </div>

    <!-- Materialize JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
